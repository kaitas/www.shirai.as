---
author: aki
title: "EXCEL2010でのヒストグラムの描き方"
slug: histgram-on-excel
id: 7110
date: '2013-06-06 21:09:04'
layout: post
categories:
  - 講義ノート
tags:
  - ヒストグラム
  - 身の回りの数学
---

「身の回りの数学」第9回「データの統計処理」の内容から引用です。

今回の講義の内容は、いつもの板書バリバリの数学チックな講義ではなく、PCの操作ばかりで数学らしくない講義になってしまいました。

自分でもこれは本意ではない、今回限りの特別編ということでご理解いただければ幸いです。

そんなわけで、フォローアップです。各自自宅で自習よろしくお願いいたします。

まずはEXCELでヒストグラムを描く方法です。

個人的には度数分布表をCOUNTIFS()を使って自分で書いて、グラフウィザードで書くのが好みです。

あまりブラックボックス化するのも考えものなので。

ですが、教科書通り、EXCEL2010の「分析ツール」を使う方法も紹介しておきます。

「ファイル→オプション→アドイン→管理」にある「Excelアドイン」の横の「設定」をクリックし「アドイン」ダイアログで「分析ツール」のチェックをONにします。

シートに戻ると「データ」メニューに「分析：データ分析」追加されています。 こちらを実行すると、様々なデータ分析処理が選べますので「ヒストグラム」を選択します。

![histgram](https://aki.shirai.as/wp-content/uploads/2013/06/histgram-300x168.png)

* 入力範囲：分析対象のデータです。下方向にデータが並びます。
* データ区間：横軸に当たる区間を1行づつ入れていきます。
* 新規ワークシート」、「グラフ作成」にチェックを入れます。

以下の様な度数分布表とヒストグラムが生成されます。

![histgramResult](https://aki.shirai.as/wp-content/uploads/2013/06/histgramResult-300x148.png)

その他、授業内で紹介した数式などはこちらの完成版EXCELを参考にすると良いと思います(公開終了)。

以下、演習問題（発展分）の補足解説です。

> (6)Q: コイン投げを100回試行して表が1、裏が0としたとき、10回、20回、50回、100回までの平均と分散を求め、母平均0.5、母分散0.25に近くなっているか求めなさい。

Ans(example):以下のデータセットをつかってみます。
```
1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0 
```


- 10 回まで 平均：0:5 分散：0:27777...
- 20 回まで 平均：0:6 分散：0:25263...
- 50 回まで 平均：0:6 分散：0:24489...
- 100 回まで 平均：0:52 分散：0:25212...


> (7) 30日分の円ドル相場の終値を調べ、度数分布表とヒストグラムを作成せよ
 
こちらのURLから生データを入手出来ます。

[https://stocks.finance.yahoo.co.jp/stocks/history/?code=USDJPY=X](https://stocks.finance.yahoo.co.jp/stocks/history/?code=USDJPY=X)

2013年5月9日～2013年6月5日までの市場が開いている日の終値は以下の20件でした。
``` 
100.59, 101.58, 101.82, 102.35, 102.23, 102.24, 103.18, 102.26, 102.46, 103.15, 102.01, 101.27, 100.93, 102.36, 101.13, 100.72, 100.46, 99.51, 100, 99.06
```

区間は99,100,101,102,103とした場合、EXCELの分析ツールでの度数分布表は、
（頻度＝）「0,3,4,4,7,2」でした。ヒストグラムは上のEXCELファイルをご参照下さい。

